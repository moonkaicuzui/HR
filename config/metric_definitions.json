{
  "version": "1.0.0",
  "description": "HR Dashboard Metric Definitions - Configuration-driven metrics with NO HARDCODING",

  "metrics": {
    "total_employees": {
      "id": "total_employees",
      "name_ko": "총 인원",
      "name_en": "Total Employees",
      "name_vi": "Tổng số nhân viên",
      "category": "headcount",
      "formula": "COUNT(active_employees)",
      "formula_description_ko": "보고서 생성일 기준 재직자 수",
      "formula_description_en": "Active employees on report generation date",
      "reference_date": "report_date",
      "data_sources": ["basic_manpower"],
      "calculation_method": "count",
      "filters": {
        "active_only": true,
        "exclude_resigned": true
      },
      "display_format": "{value}명",
      "card_number": 1,
      "show_type_breakdown": true
    },

    "absence_rate": {
      "id": "absence_rate",
      "name_ko": "결근율",
      "name_en": "Absence Rate",
      "name_vi": "Tỷ lệ vắng mặt",
      "category": "attendance",
      "formula": "100 - (SUM(actual_working_days) / SUM(total_working_days) * 100)",
      "data_sources": ["attendance", "basic_manpower"],
      "calculation_method": "percentage",
      "is_negative_metric": true,
      "thresholds": {
        "excellent": {"max": 3, "color": "#28a745"},
        "good": {"min": 3, "max": 5, "color": "#17a2b8"},
        "warning": {"min": 5, "max": 10, "color": "#ffc107"},
        "critical": {"min": 10, "color": "#dc3545"}
      },
      "display_format": "{value:.1f}%",
      "card_number": 3,
      "trend_enabled": true,
      "reusable": true
    },

    "unauthorized_absence_rate": {
      "id": "unauthorized_absence_rate",
      "name_ko": "무단결근율",
      "name_en": "Unauthorized Absence Rate",
      "name_vi": "Tỷ lệ nghỉ không phép",
      "category": "attendance",
      "formula": "SUM(unapproved_absence_days) / SUM(total_working_days) * 100",
      "data_sources": ["attendance", "basic_manpower"],
      "calculation_method": "percentage",
      "is_negative_metric": true,
      "thresholds": {
        "excellent": {"max": 1, "color": "#28a745"},
        "good": {"min": 1, "max": 2, "color": "#17a2b8"},
        "warning": {"min": 2, "max": 5, "color": "#ffc107"},
        "critical": {"min": 5, "color": "#dc3545"}
      },
      "display_format": "{value:.1f}%",
      "trend_enabled": true,
      "reusable": true
    },

    "resignation_rate": {
      "id": "resignation_rate",
      "name_ko": "퇴사율",
      "name_en": "Resignation Rate",
      "name_vi": "Tỷ lệ nghỉ việc",
      "category": "turnover",
      "formula": "(monthly_resignations / average_monthly_headcount) * 100",
      "formula_description_ko": "월 중 퇴사자 수 / 월평균 인원 * 100",
      "formula_description_en": "Monthly resignations / Average monthly headcount * 100",
      "reference_date": "month_average",
      "denominator": "average_monthly_headcount",
      "data_sources": ["basic_manpower"],
      "calculation_method": "percentage",
      "is_negative_metric": true,
      "filters": {
        "resignation_date_in_month": true
      },
      "thresholds": {
        "excellent": {"max": 2, "color": "#28a745"},
        "good": {"min": 2, "max": 5, "color": "#17a2b8"},
        "warning": {"min": 5, "max": 10, "color": "#ffc107"},
        "critical": {"min": 10, "color": "#dc3545"}
      },
      "display_format": "{value:.1f}%",
      "card_number": 4,
      "trend_enabled": true,
      "reusable": true
    },

    "recent_hires": {
      "id": "recent_hires",
      "name_ko": "이번달 입사자",
      "name_en": "Monthly New Hires",
      "name_vi": "Nhân viên mới trong tháng",
      "category": "recruitment",
      "formula": "COUNT(employees WHERE entrance_date IN target_month)",
      "formula_description_ko": "해당 월에 입사한 직원 수",
      "formula_description_en": "Employees who joined during the target month",
      "data_sources": ["basic_manpower"],
      "calculation_method": "count",
      "filters": {
        "entrance_date_in_month": true
      },
      "display_format": "{value}명",
      "card_number": 5,
      "show_rate": true,
      "rate_formula": "recent_hires / total_employees * 100"
    },

    "recent_resignations": {
      "id": "recent_resignations",
      "name_ko": "이번달 퇴사자",
      "name_en": "Monthly Resignations",
      "name_vi": "Nghỉ việc trong tháng",
      "category": "turnover",
      "formula": "COUNT(employees WHERE stop_working_date IN target_month)",
      "formula_description_ko": "해당 월에 퇴사한 직원 수",
      "formula_description_en": "Employees who resigned during the target month",
      "data_sources": ["basic_manpower"],
      "calculation_method": "count",
      "filters": {
        "resignation_date_in_month": true
      },
      "display_format": "{value}명",
      "card_number": 6,
      "show_rate": true,
      "rate_formula": "recent_resignations / total_employees * 100"
    },

    "early_turnover": {
      "id": "early_turnover",
      "name_ko": "조기 퇴사자 (30일 이내)",
      "name_en": "Early Turnover (Within 30 Days)",
      "name_vi": "Nghỉ việc sớm (trong 30 ngày)",
      "category": "turnover",
      "formula": "COUNT(employees WHERE (stop_working_date - entrance_date) <= 30 days AND stop_working_date IN target_month)",
      "formula_description_ko": "입사 30일 이내에 퇴사한 직원 수 (해당 월 퇴사자 중)",
      "formula_description_en": "Employees who resigned within 30 days of joining (among monthly resignations)",
      "data_sources": ["basic_manpower"],
      "calculation_method": "count",
      "filters": {
        "tenure_max": 30,
        "resignation_date_in_month": true
      },
      "display_format": "{value}명",
      "show_rate": true,
      "rate_formula": "early_turnover / recent_resignations * 100",
      "insight_ko": "조기 퇴사율이 높으면 채용/온보딩 프로세스 점검 필요",
      "insight_en": "High early turnover indicates need to review recruitment/onboarding process"
    },

    "under_60_days": {
      "id": "under_60_days",
      "name_ko": "입사 60일 미만",
      "name_en": "Under 60 Days Tenure",
      "name_vi": "Dưới 60 ngày",
      "category": "recruitment",
      "formula": "COUNT(employees WHERE (current_date - entrance_date) < 60 days)",
      "data_sources": ["basic_manpower"],
      "calculation_method": "count",
      "filters": {
        "tenure_max": 60,
        "active_only": true
      },
      "display_format": "{value}명",
      "card_number": 7,
      "show_rate": true,
      "rate_formula": "under_60_days / total_employees * 100"
    },

    "post_assignment_resignations": {
      "id": "post_assignment_resignations",
      "name_ko": "보직 부여 후 퇴사",
      "name_en": "Post-Assignment Resignations",
      "name_vi": "Nghỉ việc sau khi phân công",
      "category": "turnover",
      "formula": "COUNT(employees WHERE 30 < (stop_working_date - entrance_date) <= 60 days)",
      "data_sources": ["basic_manpower"],
      "calculation_method": "count",
      "filters": {
        "tenure_min": 30,
        "tenure_max": 60,
        "has_resignation_date": true
      },
      "display_format": "{value}명",
      "card_number": 8,
      "show_rate": true,
      "rate_formula": "post_assignment_resignations / under_60_days * 100"
    },

    "full_attendance": {
      "id": "full_attendance",
      "name_ko": "만근자",
      "name_en": "Full Attendance",
      "name_vi": "Chuyên cần đầy đủ",
      "category": "attendance",
      "formula": "COUNT(employees WHERE actual_working_days == total_working_days AND total_working_days > 0)",
      "data_sources": ["attendance", "basic_manpower"],
      "calculation_method": "count",
      "filters": {
        "full_attendance_only": true
      },
      "display_format": "{value}명",
      "card_number": 9,
      "show_rate": true,
      "rate_formula": "full_attendance / total_employees * 100",
      "trend_enabled": true,
      "reusable": true
    },

    "long_term_employees": {
      "id": "long_term_employees",
      "name_ko": "장기근속자 (1년 이상)",
      "name_en": "Long-term Employees (1+ year)",
      "name_vi": "Nhân viên lâu năm (1+ năm)",
      "category": "retention",
      "formula": "COUNT(employees WHERE (current_date - entrance_date) >= 365 days)",
      "data_sources": ["basic_manpower"],
      "calculation_method": "count",
      "filters": {
        "tenure_min": 365,
        "active_only": true
      },
      "display_format": "{value}명",
      "card_number": 10,
      "show_rate": true,
      "rate_formula": "long_term_employees / total_employees * 100"
    },

    "data_errors": {
      "id": "data_errors",
      "name_ko": "데이터 오류",
      "name_en": "Data Errors",
      "name_vi": "Lỗi dữ liệu",
      "category": "quality",
      "formula": "COUNT(errors FROM error_detector)",
      "data_sources": ["error_report"],
      "calculation_method": "count",
      "severity_levels": ["critical", "warning", "info"],
      "display_format": "{value}명",
      "card_number": 2,
      "is_error_metric": true
    }
  },

  "team_metrics": {
    "team_attendance_rate": {
      "id": "team_attendance_rate",
      "name_ko": "팀별 출근율",
      "name_en": "Team Attendance Rate",
      "name_vi": "Tỷ lệ chuyên cần theo nhóm",
      "category": "attendance",
      "formula": "100 - (SUM(actual_working_days) / SUM(total_working_days) * 100) GROUP BY team",
      "group_by": "team",
      "reusable": true,
      "chart_enabled": true
    },

    "team_resignation_rate": {
      "id": "team_resignation_rate",
      "name_ko": "팀별 퇴사율",
      "name_en": "Team Resignation Rate",
      "name_vi": "Tỷ lệ nghỉ việc theo nhóm",
      "category": "turnover",
      "formula": "COUNT(resignations) / COUNT(total_employees) * 100 GROUP BY team",
      "group_by": "team",
      "reusable": true,
      "chart_enabled": true
    },

    "team_headcount": {
      "id": "team_headcount",
      "name_ko": "팀별 인원수",
      "name_en": "Team Headcount",
      "name_vi": "Số lượng nhân viên theo nhóm",
      "category": "headcount",
      "formula": "COUNT(employees) GROUP BY team",
      "group_by": "team",
      "reusable": true,
      "chart_enabled": true,
      "chart_type": "treemap"
    }
  },

  "calculation_settings": {
    "date_format": "YYYY-MM-DD",
    "percentage_decimals": 1,
    "count_decimals": 0,
    "currency_symbol": "VND",
    "threshold_comparison_operator": ">=",
    "missing_data_handling": "zero",
    "zero_division_handling": 0
  },

  "data_source_mapping": {
    "basic_manpower": "input_files/basic manpower data {month}.csv",
    "attendance": "input_files/attendance/converted/attendance data {month}_converted.csv",
    "aql_history": "input_files/AQL history/1.HSRG AQL REPORT-{MONTH}.{year}.csv",
    "5prs": "input_files/5prs data {month}.csv",
    "incentive_detail": "input_files/{year}년 {month} 인센티브 지급 세부 정보.csv"
  },

  "thresholds": {
    "tenure_buckets": {
      "under_1yr": {"min_days": 0, "max_days": 365, "name_ko": "1년 미만", "name_en": "Under 1 year"},
      "1_to_3yr": {"min_days": 365, "max_days": 1095, "name_ko": "1-3년", "name_en": "1-3 years"},
      "3_to_5yr": {"min_days": 1095, "max_days": 1825, "name_ko": "3-5년", "name_en": "3-5 years"},
      "over_5yr": {"min_days": 1825, "max_days": null, "name_ko": "5년 이상", "name_en": "Over 5 years"}
    },
    "early_resignation_days": {
      "early_30": {"days": 30, "name_ko": "30일 이내 퇴사", "name_en": "Within 30 days"},
      "early_60": {"days": 60, "name_ko": "60일 이내 퇴사", "name_en": "Within 60 days"},
      "early_90": {"days": 90, "name_ko": "90일 이내 퇴사", "name_en": "Within 90 days"}
    },
    "long_term_employee_days": 365,
    "under_60_days_threshold": 60,
    "long_absence_days": 5,
    "new_hire_tracking_days": 30,
    "post_assignment_period": {
      "min_days": 30,
      "max_days": 60,
      "description_ko": "라인 배정 후 퇴사 기간",
      "description_en": "Post line assignment resignation period"
    }
  },

  "absence_reason_patterns": {
    "maternity": {
      "keywords": ["Thai sản", "Sinh", "sinh", "Dưỡng sinh", "Khám thai"],
      "description_ko": "출산휴가/임신 관련",
      "description_en": "Maternity/pregnancy related"
    },
    "unauthorized": {
      "keywords": ["AR1", "AR2", "Không phép", "Vắng không phép", "Unauthorized"],
      "description_ko": "무단결근",
      "description_en": "Unauthorized absence"
    },
    "annual_leave": {
      "keywords": ["Phép năm", "Annual leave", "Nghỉ phép", "AL"],
      "description_ko": "연차휴가",
      "description_en": "Annual leave"
    },
    "sick_leave": {
      "keywords": ["Ốm đau", "Sick leave", "Bệnh", "Sick", "SL"],
      "description_ko": "병가",
      "description_en": "Sick leave"
    }
  },

  "validation_rules": {
    "percentage_metrics": {
      "min": 0,
      "max": 100,
      "allow_exceed": false
    },
    "rate_anomaly_thresholds": {
      "absence_rate_max": 50,
      "resignation_rate_max": 30,
      "unauthorized_rate_max": 20
    }
  }
}
